# StackHawk Configuration for Vertex Streetwear
# https://docs.stackhawk.com/hawkscan/configuration/
# Tuned for a comprehensive in-depth scan (SPA + key routes + OWASP coverage).

app:
  applicationId: bd5d46c2-200f-4915-97c8-71f31e13fcfe
  env: dev
  host: http://localhost:3000

  # Paths to exclude from scanning (avoids logout/cart/GraphQL proxy)
  excludePaths:
    - ".*/api/.*graphql.*"
    - ".*/account/logout.*"
    - ".*/cart/.*"

# Global scanner settings
hawk:
  # Fail the scan if findings at or above this severity (CI-friendly)
  failureThreshold: medium

  # Spider: how HawkScan discovers routes
  spider:
    base: true
    # Enable for SPA (Hydrogen is React) so JS-rendered routes are crawled
    ajax: true
    # Allow enough time for both base and ajax crawlers
    maxDurationMinutes: 15
    # Seed paths that may not be linked from home (better coverage)
    seedPaths:
      - /
      - /collections
      - /collections/all
      - /products
      - /search
      - /account
      - /account/orders
      - /account/profile
      - /account/addresses
      - /cart
      - /blogs

  # Scan phase: duration and behavior
  scan:
    # Allow time for a thorough active scan
    maxDurationMinutes: 45

  # Optional: increase if the app is slow to start (e.g. in CI)
  # startupTimeoutMinutes: 10

# Optional: authenticated scanning (uncomment and set env vars if needed)
# app.authentication:
#   usernamePassword:
#     loginPath: /account/login
#     usernameField: email
#     passwordField: password
#     scanUsername: ${SCAN_USERNAME}
#     scanPassword: ${SCAN_PASSWORD}
#   cookieAuthorization: {}
#   loggedInIndicator: ".*account.*"
#   loggedOutIndicator: ".*login.*"
#   testPath:
#     path: /account
#     expectedStatus: 200

# Optional: GraphQL (only if you have an introspectable endpoint on this host)
# app.graphqlConf:
#   schemaPath: /api/2024-01/graphql.json

# Scan policy / test categories (OWASP-style; use if your StackHawk version supports it)
scanConfig:
  tests:
    - categoryId: INJECTION
    - categoryId: BROKEN_AUTHENTICATION
    - categoryId: SENSITIVE_DATA_EXPOSURE
    - categoryId: XXE
    - categoryId: BROKEN_ACCESS_CONTROL
    - categoryId: SECURITY_MISCONFIGURATION
    - categoryId: XSS
    - categoryId: INSECURE_DESERIALIZATION
    - categoryId: USING_COMPONENTS_WITH_KNOWN_VULNERABILITIES
    - categoryId: INSUFFICIENT_LOGGING_AND_MONITORING

tags:
  - name: project
    value: vertex-streetwear
  - name: framework
    value: hydrogen
  - name: language
    value: javascript
